from config import HTMLTestRunner
import unittest
from unittest import TestLoader,TestSuite,TestCase
from interface.index import MyTestCaseIndex,MYTestCaseNewinformation
from interface.news import NewsTest
from interface.idata import InsightDataTest
from interface.cytab import ProjectDetailsTest
# H:\seleuim\jingdata_saas_py是GitHub
def allTest():
    suite1 = TestLoader().loadTestsFromTestCase(MyTestCaseIndex)
    suite2 = TestLoader().loadTestsFromTestCase(MYTestCaseNewinformation)
    suite3 = TestLoader().loadTestsFromTestCase(NewsTest)
    suite4 = TestLoader().loadTestsFromTestCase(InsightDataTest)
    suite5 = TestLoader().loadTestsFromTestCase(ProjectDetailsTest)  #全部公司表头字段筛选
    #suite5 = TestLoader().loadTestsFromTestCase(HeadersortTest) #全部公司表头字段排序
    alltests = TestSuite([suite1,suite2,suite3,suite4,suite5])
    return alltests

if __name__ == '__main__':
    #filepath = 'H:/seleuim/jingdata_saas_py/report.html'

    #filepath = 'C:/Program Files (x86)/Jenkins/workspace/pytest002/report/1eport.html'
    #filepath = 'C:/Program Files (x86)/Jenkins/workspace/pytest002/report/1eport.html'
    #filepath = 'H:/report.html'
    filepath = './report/report.html'
    ftp = open(filepath, 'wb')
    runner = HTMLTestRunner.HTMLTestRunner(stream=ftp, title='鲸准接口平台')
    runner.run(allTest())
    unittest.main()